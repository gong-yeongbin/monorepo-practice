// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("MYSQL")
}

model user {
  id       Int    @id @default(autoincrement())
  user_id  String @unique
  password String @db.VarChar(20)
  salt     String @db.VarChar(50)
  role     String @db.Char(10)
}

model tracker {
  id                   Int    @id @default(autoincrement())
  name                 String @unique @db.VarChar(30)
  tracking_url         String @db.Text
  install_postback_url String @db.Text
  event_postback_url   String @db.Text
}

model media {
  id                   Int    @id @default(autoincrement())
  name                 String @unique @db.VarChar(30)
  install_postback_url String @db.Text
  event_postback_url   String @db.Text

  campaign campaign[]
}

model ad {
  id              Int     @id @default(autoincrement())
  advertiser_name String  @db.VarChar(30)
  name            String  @unique @db.VarChar(30)
  image           String? @db.Text

  campaign campaign[]
}

model campaign {
  id                     Int                      @id @default(autoincrement())
  token                  String                   @unique @db.VarChar(50)
  name                   String                   @unique @db.VarChar(30)
  type                   String                   @db.Char(10) // CPI, CPA
  tracker_tracking_url   String                   @db.Text
  tracking_url           String                   @db.Text
  ad                     ad                       @relation(fields: [ad_id], references: [id])
  ad_id                  Int
  media                  media                    @relation(fields: [media_id], references: [id])
  media_id               Int
  is_block               Boolean                  @default(false)
  campaign_event_mapping campaign_event_mapping[]
}

model campaign_event_mapping {
  id                 Int      @id @default(autoincrement())
  campaign           campaign @relation(fields: [campaign_id], references: [id])
  campaign_id        Int
  tracker_event_name String   @db.VarChar(30)
  admin_label        String   @db.VarChar(30)
  media_send_name    String   @db.VarChar(30)
}
